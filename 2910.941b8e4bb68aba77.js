"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2910],{2910:(T,l,s)=>{s.r(l),s.d(l,{BuyModule:()=>y});var p=s(3071),e=s(6738),g=s(7827),d=s(6895),c=s(4006);function h(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"tr",13)(1,"td",14)(2,"p",15),e._uU(3),e.qZA(),e.TgZ(4,"p",16),e._uU(5," \u0417\u0430\u043a\u0430\u0437\u0430\u043d\u043e on-line: "),e.TgZ(6,"span"),e._uU(7),e.qZA()(),e.TgZ(8,"p",16),e._uU(9," \u0426\u0435\u043d\u0430 \u0437\u0430 1 \u0448\u0442. "),e.TgZ(10,"span"),e._uU(11),e.ALo(12,"currency"),e.qZA()(),e.TgZ(13,"p",17),e._uU(14,"\u0418\u0442\u043e\u0433\u043e: "),e.TgZ(15,"span"),e._uU(16),e.ALo(17,"currency"),e.qZA()(),e.TgZ(18,"ul",18)(19,"li")(20,"a",9),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,a=e.oxw();return e.KtG(a.downloadPdf(o.date,o.number))}),e._uU(21,"\u0421\u043a\u0430\u0447\u0430\u0442\u044c PDF"),e.qZA()(),e.TgZ(22,"li")(23,"a",9),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,a=e.oxw();return e.KtG(a.downloadExcel(o.date,o.number))}),e._uU(24,"\u0421\u043a\u0430\u0447\u0430\u0442\u044c Excel"),e.qZA()()()()()}if(2&n){const t=i.$implicit,u=e.oxw().$implicit;e.ekj("show",u.open),e.xp6(3),e.Oqu(t.goods),e.xp6(4),e.hij("",t.count," \u0448\u0442."),e.xp6(4),e.Oqu(e.Dn7(12,6,t.price,void 0,"\u0420")),e.xp6(5),e.hij(" ",e.Dn7(17,10,t.sum,void 0,"\u0420"),"")}}function m(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"tr",9),e.NdJ("click",function(){const a=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.toggle(a.number))}),e.TgZ(1,"td"),e.O4$(),e.TgZ(2,"svg",10),e._UZ(3,"path",11),e.qZA()(),e.kcU(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.ALo(8,"currency"),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"date"),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.qZA()(),e.YNc(14,h,25,14,"tr",12)}if(2&n){const t=i.$implicit;e.ekj("active",t.open),e.xp6(5),e.Oqu(t.number),e.xp6(2),e.Oqu(e.Dn7(8,7,t.sum,void 0,"\u0420")),e.xp6(3),e.Oqu(e.xi3(11,11,t.date,"d MMM y")),e.xp6(3),e.Oqu(t.department),e.xp6(1),e.Q6J("ngForOf",null==t?null:t.purchaseInfo)}}const f=[{path:"",component:(()=>{class n{constructor(t){this.api=t,this.purchases=[]}ngOnInit(){this.loadPurchases()}toggle(t){const u=this.purchases.find(o=>o.number===t);u.open?u.open=!1:(u.open=!0,u.purchaseInfo||this.loadPurchaseInfo(u.date,t))}downloadPdf(t,u){this.api.getPdf(t,u,"purchase").subscribe(o=>{this.saveFile(o.base64,"application/pdf",`${u}.pdf`)})}downloadExcel(t,u){this.api.getExcel(t,u,"purchase").subscribe(o=>{this.saveFile(o.base64,"application/vnd.ms-excel",`${u}.xls`)})}dateRangeChanged(){this.dateTo&&this.dateFrom&&this.isDateRangeValid()&&this.loadPurchasesByDateRange()}saveFile(t,u,o){const a=`data:${u};base64,${t}`,r=document.createElement("a");r.href=a,r.download=o,r.click()}loadPurchases(){this.api.getPurchases().subscribe(t=>{t&&(this.purchases=t)})}loadPurchasesByDateRange(){this.api.getPurchases({from:this.dateFrom,to:this.dateTo}).subscribe(u=>{u&&(this.purchases=u)})}loadPurchaseInfo(t,u){this.api.getPurchaseInfo(t,u).subscribe(o=>{this.purchases.find(a=>a.number===u).purchaseInfo=o})}isDateRangeValid(){return new Date(this.dateFrom).getTime()<=new Date(this.dateTo).getTime()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(g.s))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-buy-page"]],decls:25,vars:9,consts:[[1,"perconal-data__inner","--white"],[1,"perconal-data-filters"],[1,"perconal-data-filter"],[1,"perconal-data__inputs"],["type","date","id","from","name","from",3,"ngModel","ngModelChange"],["type","date","id","to","name","to",3,"ngModel","ngModelChange"],[1,"text-content"],[1,"table-large"],["ngFor","",3,"ngForOf"],[3,"click"],["xmlns","http://www.w3.org/2000/svg","width","192","height","320","viewBox","0 0 192 320","fill","none"],["d","M0 19.4L20.7 0L192 160L20.7 320L0 300.7L150.5 160L0 19.4Z","fill","#ed553b"],["class","hidden-row",3,"show",4,"ngFor","ngForOf"],[1,"hidden-row"],["colspan","6"],[1,"title"],[1,"descr"],[1,"price-number"],[1,"links"]],template:function(t,u){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"p"),e._uU(4,"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0435\u0440\u0438\u043e\u0434:"),e.qZA(),e.TgZ(5,"div",3)(6,"input",4),e.NdJ("ngModelChange",function(a){return u.dateFrom=a,u.dateRangeChanged()}),e.ALo(7,"date"),e.qZA(),e.TgZ(8,"input",5),e.NdJ("ngModelChange",function(a){return u.dateTo=a,u.dateRangeChanged()}),e.ALo(9,"date"),e.qZA()()()(),e.TgZ(10,"div",6)(11,"table",7)(12,"thead")(13,"tr"),e._UZ(14,"th"),e.TgZ(15,"th"),e._uU(16,"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0437\u0430\u043a\u0430\u0437\u0430"),e.qZA(),e.TgZ(17,"th"),e._uU(18,"\u0421\u0443\u043c\u043c\u0430 \u0437\u0430\u043a\u0430\u0437\u0430"),e.qZA(),e.TgZ(19,"th"),e._uU(20,"\u0414\u0430\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u0430"),e.qZA(),e.TgZ(21,"th"),e._uU(22,"\u041e\u0442\u0434\u0435\u043b"),e.qZA()()(),e.TgZ(23,"tbody"),e.YNc(24,m,15,14,"ng-template",8),e.qZA()()()()),2&t&&(e.xp6(6),e.Q6J("ngModel",e.xi3(7,3,u.dateFrom,"yyyy-MM-dd")),e.xp6(2),e.Q6J("ngModel",e.xi3(9,6,u.dateTo,"yyyy-MM-dd")),e.xp6(16),e.Q6J("ngForOf",u.purchases))},dependencies:[d.sg,c.Fj,c.JJ,c.On,d.H9,d.uU]}),n})()}];let _=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[p.Bz.forChild(f),p.Bz]}),n})();var Z=s(1779);let y=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[d.ez,Z.m,_]}),n})()}}]);