"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3344],{3344:(T,p,i)=>{i.r(p),i.d(p,{OrdersModule:()=>O});var c=i(3071),e=i(6738),g=i(7827),s=i(6895),l=i(4006);function m(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"tr",13)(1,"td",14)(2,"p",15),e._uU(3),e.qZA(),e.TgZ(4,"p",16),e._uU(5," \u0417\u0430\u043a\u0430\u0437\u0430\u043d\u043e on-line: "),e.TgZ(6,"span"),e._uU(7),e.qZA()(),e.TgZ(8,"p",16),e._uU(9," \u0426\u0435\u043d\u0430 \u0437\u0430 1 \u0448\u0442.: "),e.TgZ(10,"span"),e._uU(11),e.ALo(12,"currency"),e.qZA()(),e.TgZ(13,"p",17),e._uU(14,"\u0418\u0442\u043e\u0433\u043e: "),e.TgZ(15,"span"),e._uU(16),e.ALo(17,"currency"),e.qZA()(),e.TgZ(18,"ul",18)(19,"li")(20,"a",9),e.NdJ("click",function(){e.CHM(t);const u=e.oxw().$implicit,r=e.oxw();return e.KtG(r.downloadPdf(u.date,u.number))}),e._uU(21,"\u0421\u043a\u0430\u0447\u0430\u0442\u044c PDF"),e.qZA()(),e.TgZ(22,"li")(23,"a",9),e.NdJ("click",function(){e.CHM(t);const u=e.oxw().$implicit,r=e.oxw();return e.KtG(r.downloadExcel(u.date,u.number))}),e._uU(24,"\u0421\u043a\u0430\u0447\u0430\u0442\u044c Excel"),e.qZA()()()()()}if(2&o){const t=d.$implicit,n=e.oxw().$implicit;e.ekj("show",n.open),e.xp6(3),e.Oqu(t.goods),e.xp6(4),e.hij("",t.count," \u0448\u0442."),e.xp6(4),e.Oqu(e.Dn7(12,6,t.price,void 0,"\u0420")),e.xp6(5),e.hij(" ",e.Dn7(17,10,t.sum,void 0,"\u0420"),"")}}function f(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"tr",9),e.NdJ("click",function(){const r=e.CHM(t).$implicit,a=e.oxw();return e.KtG(a.toggle(r.number))}),e.TgZ(1,"td"),e.O4$(),e.TgZ(2,"svg",10),e._UZ(3,"path",11),e.qZA()(),e.kcU(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.ALo(8,"currency"),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"date"),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.ALo(14,"date"),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.qZA()(),e.YNc(17,m,25,14,"tr",12)}if(2&o){const t=d.$implicit;e.ekj("active",t.open),e.xp6(5),e.Oqu(t.number),e.xp6(2),e.Oqu(e.Dn7(8,8,t.sum,void 0,"\u0420")),e.xp6(3),e.Oqu(e.xi3(11,12,t.order_date,"d MMM y")),e.xp6(3),e.Oqu(e.xi3(14,15,t.date,"d MMM y")),e.xp6(3),e.Oqu(t.department),e.xp6(1),e.Q6J("ngForOf",null==t?null:t.orderInfo)}}const h=[{path:"",component:(()=>{class o{constructor(t){this.api=t}ngOnInit(){this.loadOrders()}toggle(t){const n=this.orders.find(u=>u.number===t);n.open?n.open=!1:(n.open=!0,n.orderInfo||this.loadOrderInfo(n.date,t))}downloadPdf(t,n){this.api.getPdf(t,n,"order").subscribe(u=>{this.saveFile(u.base64,"application/pdf",`${n}.pdf`)})}downloadExcel(t,n){this.api.getExcel(t,n,"order").subscribe(u=>{this.saveFile(u.base64,"application/vnd.ms-excel",`${n}.xls`)})}dateRangeChanged(){this.dateTo&&this.dateFrom&&this.isDateRangeValid()&&this.loadOrdersByDateRange()}saveFile(t,n,u){const r=`data:${n};base64,${t}`,a=document.createElement("a");a.href=r,a.download=u,a.click()}loadOrders(){this.api.getOrders().subscribe(t=>{t&&(this.orders=t)})}loadOrdersByDateRange(){this.api.getOrders({from:this.dateFrom,to:this.dateTo}).subscribe(n=>{n&&(this.orders=n)})}loadOrderInfo(t,n){this.api.getOrderInfo(t,n).subscribe(u=>{this.orders.find(r=>r.number===n).orderInfo=u})}isDateRangeValid(){return new Date(this.dateFrom).getTime()<=new Date(this.dateTo).getTime()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(g.s))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-orders-page"]],decls:27,vars:9,consts:[[1,"perconal-data__inner","--white"],[1,"perconal-data-filters"],[1,"perconal-data-filter"],[1,"perconal-data__inputs"],["type","date","id","from","name","from",3,"ngModel","ngModelChange"],["type","date","id","to","name","to",3,"ngModel","ngModelChange"],[1,"text-content"],[1,"table-large"],["ngFor","",3,"ngForOf"],[3,"click"],["xmlns","http://www.w3.org/2000/svg","width","192","height","320","viewBox","0 0 192 320","fill","none"],["d","M0 19.4L20.7 0L192 160L20.7 320L0 300.7L150.5 160L0 19.4Z","fill","#ed553b"],["class","hidden-row",3,"show",4,"ngFor","ngForOf"],[1,"hidden-row"],["colspan","6"],[1,"title"],[1,"descr"],[1,"price-number"],[1,"links"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"p"),e._uU(4,"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0435\u0440\u0438\u043e\u0434:"),e.qZA(),e.TgZ(5,"div",3)(6,"input",4),e.NdJ("ngModelChange",function(r){return n.dateFrom=r,n.dateRangeChanged()}),e.ALo(7,"date"),e.qZA(),e.TgZ(8,"input",5),e.NdJ("ngModelChange",function(r){return n.dateTo=r,n.dateRangeChanged()}),e.ALo(9,"date"),e.qZA()()()(),e.TgZ(10,"div",6)(11,"table",7)(12,"thead")(13,"tr"),e._UZ(14,"th"),e.TgZ(15,"th"),e._uU(16,"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0437\u0430\u043a\u0430\u0437\u0430"),e.qZA(),e.TgZ(17,"th"),e._uU(18,"\u0421\u0443\u043c\u043c\u0430 \u0437\u0430\u043a\u0430\u0437\u0430"),e.qZA(),e.TgZ(19,"th"),e._uU(20,"\u0414\u0430\u0442\u0430 \u043f\u043e\u0441\u0442\u0430\u0432\u043a\u0438"),e.qZA(),e.TgZ(21,"th"),e._uU(22,"\u0414\u0430\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u0430"),e.qZA(),e.TgZ(23,"th"),e._uU(24,"\u041e\u0442\u0434\u0435\u043b"),e.qZA()()(),e.TgZ(25,"tbody"),e.YNc(26,f,18,18,"ng-template",8),e.qZA()()()()),2&t&&(e.xp6(6),e.Q6J("ngModel",e.xi3(7,3,n.dateFrom,"yyyy-MM-dd")),e.xp6(2),e.Q6J("ngModel",e.xi3(9,6,n.dateTo,"yyyy-MM-dd")),e.xp6(18),e.Q6J("ngForOf",n.orders))},dependencies:[s.sg,l.Fj,l.JJ,l.On,s.H9,s.uU]}),o})()}];let _=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[c.Bz.forChild(h),c.Bz]}),o})();var Z=i(1779);let O=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[s.ez,Z.m,_]}),o})()}}]);